# 当我们在浏览器中输入`url`之后，网络上都会发生什么？

作为前端开发，我们想要知道输入`url`后发生了什么，首先要知道`url`是什么，由什么组成？

`url`的组成：
协议名+域名+端口号+路径+查询字符串+片段标识符

其次再必须对`http`请求以及浏览器的渲染过程有一定的了解，那么在浏览器中输入`url`后发生了什么：

解析`DNS`，检查浏览器是否有缓存或缓存是否过期，建立`IP`链接

建立`TCP`链接

发起`HTTP`请求

收到服务器端响应

浏览器解析数据

关闭`TCP`链接

## 1、解析DNS

在解析`DNS`的过程中，首先检测系统缓存，如果没有或已过期，则会根据域名从顶级、一级...开始查找，直到找到对应的服务器，然后建立`IP`链接

## 2、建立`TCP`链接

建立`TCP`链接，就是通常说的三次握手，首先是客户端向服务器发送请求是否可建立链接，服务器返回同意后，客户端回馈服务器的响应，即完成3次通话。

## 3、发送`HTTP`请求

在完成3次握手后，由客户端向服务器端发送`http`请求，`http`请求内容包括：
请求行：方法+地址+http版本

请求头

请求体

## 4、服务器处理请求并返回`http`报文

服务器端接到`http`请求后会作出响应，响应内容包括：

响应行：http版本+状态码+状态描述

响应头

响应体

其中响应的状态码包括：

`2xx` 成功

`3xx` 重定向

`4xx` 客户端错误

`5xx` 服务器端错误

## 5、浏览器渲染

在客户端还没有完全接收完到服务器端的响应内容后，便已经开始在浏览器中渲染页面了，渲染过程包括：
解析`DOM Tree`

解析`CSS Tree`

把`DOM Tree`+`CSS Tree`布局绘制到屏幕

在布局中有两个概念：重排和重绘，这两个动作如果频繁的话会非常影响页面性能，所以我们尽量避免以下会引起重排和重绘的操作，增删改`DOM`、移动`DOM`位置、修改`DOM`内容、修改`CSS resize`窗口、修改网页默认字体、获取某些属性：`width`、`offset-Top`

解析`JS`

在解析`html`时，遇到`js`代码会停止解析`html`进行`js`解析，但是在`js`执行前必须保证`css`文件已经加载完。

`js`执行都是单线程的，因为他的用途决定了他就是个单线程，那么的异步操作是怎么来的呢？
`js`执行时分同步任务和异步任务，在主线程执行同步任务，称其为执行栈。开启浏览器其他线程执行异步任务，称其为任务队列。`js`执行时先依次执行执行栈，完成后再从任务队列中提取事件，进行回调执行。

## 6、关闭`TCP`链接

